<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>è€å¸«æ™‚æ•¸è¨ˆç®—å™¨ (Excel åŒ¯å…¥ç‰ˆ)</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <style>
    body {
      font-family: "Microsoft JhengHei", sans-serif;
      background: #fff8e1;
      padding: 20px;
    }
    h2 {
      color: #d35400;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }
    th, td {
      border: 1px solid #aaa;
      padding: 10px;
      text-align: center;
    }
    input[type="file"] {
      margin-top: 10px;
    }
    button {
      margin-top: 15px;
      padding: 8px 12px;
      background-color: #ffa726;
      border: none;
      color: white;
      border-radius: 5px;
      cursor: pointer;
    }
    button:hover {
      background-color: #fb8c00;
    }
  </style>
</head>
<body>

  <h2>ğŸ“‚ è€å¸«ä¸Šèª²æ™‚æ•¸è¨ˆç®—å™¨ï¼ˆExcel è‡ªå‹•åŒ¯å…¥ï¼‰</h2>

  <input type="file" id="uploadExcel" accept=".xlsx">
  <table id="teacherTable">
    <thead>
      <tr>
        <th>å§“å</th>
        <th>æ­£å¸¸æ™‚æ•¸</th>
        <th>å¸¸æ…‹è¶…é˜</th>
        <th>ç‰¹æ®Šä»£èª²è¶…é˜</th>
        <th>åˆè¨ˆç¸½æ™‚æ•¸</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    document.getElementById('uploadExcel').addEventListener('change', function (e) {
      const file = e.target.files[0];
      const reader = new FileReader();

      reader.onload = function (event) {
        const data = new Uint8Array(event.target.result);
        const workbook = XLSX.read(data, { type: 'array' });
        const sheetName = workbook.SheetNames[0];
        const sheet = workbook.Sheets[sheetName];
        const jsonData = XLSX.utils.sheet_to_json(sheet, { defval: 0 }); // defval: 0 å¯é¿å…ç©ºæ ¼è®Š undefined

        const tbody = document.querySelector("#teacherTable tbody");
        tbody.innerHTML = ""; // æ¸…ç©ºèˆŠè³‡æ–™

        jsonData.forEach(row => {
          const name = row["å§“å"] || "ï¼ˆç„¡åï¼‰";
          const normal = parseFloat(row["æ­£å¸¸æ™‚æ•¸"]) || 0;
          const ot1 = parseFloat(row["å¸¸æ…‹è¶…é˜"]) || 0;
          const ot2 = parseFloat(row["ç‰¹æ®Šä»£èª²è¶…é˜"]) || 0;
          const total = normal + ot1 + ot2;

          const tr = document.createElement("tr");
          tr.innerHTML = `
            <td>${name}</td>
            <td>${normal}</td>
            <td>${ot1}</td>
            <td>${ot2}</td>
            <td><strong>${total}</strong></td>
          `;
          tbody.appendChild(tr);
        });
      };

      reader.readAsArrayBuffer(file);
    });
  </script>

</body>
</html>
